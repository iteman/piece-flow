<?xml version="1.0" encoding="UTF-8" ?>
<!-- $Id$ -->
<!DOCTYPE package SYSTEM "http://pear.php.net/dtd/package-1.0">
<package version="1.0" packagerversion="1.5.0RC2">
 <name>Piece_Flow</name>
 <summary>A web flow engine and a continuation server</summary>
 <description>Piece_Flow is a generic web flow engine and a continuation server based on Finite State Machine(FSM). Piece_Flow provides a stateful programming model for developers, and high security for applications.
 </description>
 <maintainers>
  <maintainer>
   <user>iteman</user>
   <name>KUBO Atsuhiro</name>
   <email>iteman@users.sourceforge.net</email>
   <role>lead</role>
  </maintainer>
  </maintainers>
 <release>
  <version>1.8.0</version>
  <date>2006-12-20</date>
  <license>BSD License (revised)</license>
  <state>stable</state>
  <notes>This release includes a feature named &quot;Action Continuation&quot; and several enhancements.

&quot;Action Continuation&quot; is a very important feature for developers. This feature will allow developers to write stateful action code via the properties without using flow attributes. This means that the programming be nearer natural continuation programming, although it is limited the scope in the action.

See the following release notes for details.

## Enhancements ##

### Piece_Flow_Continuation, Piece_Flow_Action_Factory ###

- Added a feature to store the action instances as a flow attribute in a flow execution, and restore the action instances when continuing the flow execution. (Ticket #13)

### Piece_Flow_Continuation ###

- Removed setActionDirectory().
- Changed to start a new flow execution if another flow execution of the current flow already exists in the flow executions. (Ticket #14)
- Added isExclusive() to check whether the curent flow execution is exclusive or not.
- Added getCurrentFlowName() to get the current flow name.

### Piece_Flow_Action_Factory ###

- Added clearInstances() to clear all instances of actions. (Ticket #12)
- Moved _load() to load() as a public method.
  </notes>
  <deps>
   <dep type="php" rel="ge" version="4.3.0" optional="no"/>
   <dep type="pkg" rel="ge" version="1.8.0" optional="no">Stagehand_FSM</dep>
   <dep type="pkg" rel="ge" version="1.7.0" optional="no">Cache_Lite</dep>
   <dep type="pkg" rel="ge" version="1.4.3" optional="no">PEAR</dep>
   <dep type="pkg" rel="ge" version="0.4.0" optional="yes">Stagehand_TestRunner</dep>
  </deps>
  <filelist>
   <dir name="/" baseinstalldir="/">
    <dir name="data">
     <file role="data" name="piece-flow.rng">
      <replace from="@package_version@" to="version" type="package-info"/>
     </file>
     <file role="data" name="piece-flow.yaml">
      <replace from="@package_version@" to="version" type="package-info"/>
     </file>
     <file role="data" name="Registration.xml">
      <replace from="@package_version@" to="version" type="package-info"/>
     </file>
     <file role="data" name="Registration.yaml">
      <replace from="@package_version@" to="version" type="package-info"/>
     </file>
    </dir> <!-- /data -->
    <dir name="docs">
     <file role="doc" name="LICENSE">
      <replace from="@package_version@" to="version" type="package-info"/>
     </file>
    </dir> <!-- /docs -->
    <dir name="Piece">
     <dir name="Flow">
      <dir name="Action">
       <file role="php" name="Factory.php">
        <replace from="@package_version@" to="version" type="package-info"/>
       </file>
       <file role="php" name="Invoker.php">
        <replace from="@package_version@" to="version" type="package-info"/>
       </file>
      </dir> <!-- /Piece/Flow/Action -->
      <dir name="ConfigReader">
       <file role="php" name="Common.php">
        <replace from="@package_version@" to="version" type="package-info"/>
       </file>
       <file role="php" name="Factory.php">
        <replace from="@package_version@" to="version" type="package-info"/>
       </file>
       <file role="php" name="XML4.php">
        <replace from="@package_version@" to="version" type="package-info"/>
       </file>
       <file role="php" name="XML5.php">
        <replace from="@package_version@" to="version" type="package-info"/>
       </file>
       <file role="php" name="YAML.php">
        <replace from="@package_version@" to="version" type="package-info"/>
       </file>
      </dir> <!-- /Piece/Flow/ConfigReader -->
      <file role="php" name="Action.php">
       <replace from="@package_version@" to="version" type="package-info"/>
      </file>
      <file role="php" name="Config.php">
       <replace from="@package_version@" to="version" type="package-info"/>
      </file>
      <file role="php" name="Continuation.php">
       <replace from="@package_version@" to="version" type="package-info"/>
      </file>
      <file role="php" name="Error.php">
       <replace from="@package_version@" to="version" type="package-info"/>
      </file>
     </dir> <!-- /Piece/Flow -->
     <file role="php" name="Flow.php">
      <replace from="@package_version@" to="version" type="package-info"/>
     </file>
    </dir> <!-- /Piece -->
    <dir name="tests">
     <dir name="Piece">
      <dir name="actions">
       <file role="test" name="OmitClassNameAction.php">
        <replace from="@package_version@" to="version" type="package-info"/>
       </file>
      </dir> <!-- /tests/Piece/actions -->
      <dir name="Flow">
       <dir name="Action">
        <file role="test" name="BarAction.php">
         <replace from="@package_version@" to="version" type="package-info"/>
        </file>
        <file role="test" name="FactoryTestCase.php">
         <replace from="@package_version@" to="version" type="package-info"/>
        </file>
        <file role="test" name="FooAction.php">
         <replace from="@package_version@" to="version" type="package-info"/>
        </file>
        <file role="test" name="InvalidAction.php">
         <replace from="@package_version@" to="version" type="package-info"/>
        </file>
        <file role="test" name="InvokerTestCase.php">
         <replace from="@package_version@" to="version" type="package-info"/>
        </file>
        <file role="test" name="TestRunner.php">
         <replace from="@package_version@" to="version" type="package-info"/>
        </file>
       </dir> <!-- /tests/Piece/Flow/Action -->
       <dir name="actions">
        <file role="test" name="BindActionsWithFlowExecutionAction.php">
         <replace from="@package_version@" to="version" type="package-info"/>
        </file>
       </dir> <!-- /tests/Piece/Flow/actions -->
       <dir name="ConfigReader">
        <file role="test" name="Baz.php">
         <replace from="@package_version@" to="version" type="package-info"/>
        </file>
        <file role="test" name="broken.xml">
         <replace from="@package_version@" to="version" type="package-info"/>
        </file>
        <file role="test" name="CompatibilityTest.php">
         <replace from="@package_version@" to="version" type="package-info"/>
        </file>
        <file role="test" name="FactoryTestCase.php">
         <replace from="@package_version@" to="version" type="package-info"/>
        </file>
        <file role="test" name="invalid.xml">
         <replace from="@package_version@" to="version" type="package-info"/>
        </file>
        <file role="test" name="TestRunner.php">
         <replace from="@package_version@" to="version" type="package-info"/>
        </file>
        <file role="test" name="XML4TestCase.php">
         <replace from="@package_version@" to="version" type="package-info"/>
        </file>
        <file role="test" name="XML5TestCase.php">
         <replace from="@package_version@" to="version" type="package-info"/>
        </file>
        <file role="test" name="YAMLTestCase.php">
         <replace from="@package_version@" to="version" type="package-info"/>
        </file>
       </dir> <!-- /tests/Piece/Flow/ConfigReader -->
       <dir name="flows">
        <file role="test" name="BindActionsWithFlowExecution.yaml">
         <replace from="@package_version@" to="version" type="package-info"/>
        </file>
       </dir> <!-- /tests/Piece/Flow/flows -->
       <file role="test" name="ContinuationTestCase.php">
        <replace from="@package_version@" to="version" type="package-info"/>
       </file>
       <file role="test" name="Counter.yaml">
        <replace from="@package_version@" to="version" type="package-info"/>
       </file>
       <file role="test" name="CounterAction.php">
        <replace from="@package_version@" to="version" type="package-info"/>
       </file>
       <file role="test" name="FooAction.php">
        <replace from="@package_version@" to="version" type="package-info"/>
       </file>
       <file role="test" name="SecondCounter.yaml">
        <replace from="@package_version@" to="version" type="package-info"/>
       </file>
       <file role="test" name="SecondCounterAction.php">
        <replace from="@package_version@" to="version" type="package-info"/>
       </file>
       <file role="test" name="Shutdown.yaml">
        <replace from="@package_version@" to="version" type="package-info"/>
       </file>
       <file role="test" name="ShutdownAction.php">
        <replace from="@package_version@" to="version" type="package-info"/>
       </file>
       <file role="test" name="TestRunner.php">
        <replace from="@package_version@" to="version" type="package-info"/>
       </file>
      </dir> <!-- /tests/Piece/Flow -->
      <dir name="flows">
       <file role="test" name="OmitClassName.xml">
        <replace from="@package_version@" to="version" type="package-info"/>
       </file>
       <file role="test" name="OmitClassName.yaml">
        <replace from="@package_version@" to="version" type="package-info"/>
       </file>
      </dir> <!-- /tests/Piece/flows -->
      <file role="test" name="CDPlayer.yaml">
       <replace from="@package_version@" to="version" type="package-info"/>
      </file>
      <file role="test" name="FlowCDPlayerAction.php">
       <replace from="@package_version@" to="version" type="package-info"/>
      </file>
      <file role="test" name="FlowInitialAction.php">
       <replace from="@package_version@" to="version" type="package-info"/>
      </file>
      <file role="test" name="FlowInvalidEventFromTransitionActionsOrActivitiesAction.php">
       <replace from="@package_version@" to="version" type="package-info"/>
      </file>
      <file role="test" name="FlowProblemThatActivityIsInvokedTwiceUnexpectedlyAction.php">
       <replace from="@package_version@" to="version" type="package-info"/>
      </file>
      <file role="test" name="FlowTestCase.php">
       <replace from="@package_version@" to="version" type="package-info"/>
      </file>
      <file role="test" name="FlowTestCaseAction.php">
       <replace from="@package_version@" to="version" type="package-info"/>
      </file>
      <file role="test" name="initial.xml">
       <replace from="@package_version@" to="version" type="package-info"/>
      </file>
      <file role="test" name="initial.yaml">
       <replace from="@package_version@" to="version" type="package-info"/>
      </file>
      <file role="test" name="invalid.yaml">
       <replace from="@package_version@" to="version" type="package-info"/>
      </file>
      <file role="test" name="InvalidEventFromTransitionActionsOrActivities.yaml">
       <replace from="@package_version@" to="version" type="package-info"/>
      </file>
      <file role="test" name="optional.xml">
       <replace from="@package_version@" to="version" type="package-info"/>
      </file>
      <file role="test" name="optional.yaml">
       <replace from="@package_version@" to="version" type="package-info"/>
      </file>
      <file role="test" name="ProblemThatActivityIsInvokedTwiceUnexpectedly.yaml">
       <replace from="@package_version@" to="version" type="package-info"/>
      </file>
      <file role="test" name="ProtectedEvents.yaml">
       <replace from="@package_version@" to="version" type="package-info"/>
      </file>
      <file role="test" name="ProtectedStates.yaml">
       <replace from="@package_version@" to="version" type="package-info"/>
      </file>
      <file role="test" name="TestRunner.php">
       <replace from="@package_version@" to="version" type="package-info"/>
      </file>
     </dir> <!-- /tests/Piece -->
     <file role="test" name="AllTestRunner.php">
      <replace from="@package_version@" to="version" type="package-info"/>
     </file>
    </dir> <!-- /tests -->
   </dir> <!-- / -->
  </filelist>
 </release>
 <changelog>
  <release>
   <version>1.8.0</version>
   <date>2006-12-20</date>
   <license>BSD License (revised)</license>
   <state>stable</state>
   <notes>This release includes a feature named &quot;Action Continuation&quot; and several enhancements.

&quot;Action Continuation&quot; is a very important feature for developers. This feature will allow developers to write stateful action code via the properties without using flow attributes. This means that the programming be nearer natural continuation programming, although it is limited the scope in the action.

See the following release notes for details.

## Enhancements ##

### Piece_Flow_Continuation, Piece_Flow_Action_Factory ###

- Added a feature to store the action instances as a flow attribute in a flow execution, and restore the action instances when continuing the flow execution. (Ticket #13)

### Piece_Flow_Continuation ###

- Removed setActionDirectory().
- Changed to start a new flow execution if another flow execution of the current flow already exists in the flow executions. (Ticket #14)
- Added isExclusive() to check whether the curent flow execution is exclusive or not.
- Added getCurrentFlowName() to get the current flow name.

### Piece_Flow_Action_Factory ###

- Added clearInstances() to clear all instances of actions. (Ticket #12)
- Moved _load() to load() as a public method.
   </notes>
  </release>
  <release>
   <version>1.7.0</version>
   <date>2006-11-18</date>
   <license>BSD License (revised)</license>
   <state>stable</state>
   <notes>This release includes a security fix for a Cross Site Request Forgery (CSRF) vulnerability and a minor fix in the continuation server, and a few enhancements. See the following release notes for details.

## Enhancements ##

### Piece_Flow_Continuation ###

- Added getFlowExecutionTicketByFlowName() method for getting a flow execution ticket by the given flow name. (Ticket #5)

### Piece_Flow_Action_Invoker, Piece_Flow_Action ###

- Added the code so as to be able to prepare something for a callback before invoking the callback. (Ticket #6)

### Other Changes ###

- Changed so as to be able to omit the class attribute for a callback. If the class attribute is omitted, ClassNameAction class is used. (Ticket #8)

## Defect Fixes ##

### Piece_Flow_Continuation ###

- Changed the behaviour of preparing flow execution so as to require a flow execution ticket whenever continuing a flow execution even though what the flow execution mode is. (Ticket #2)
- Changed the behaviour of preparing flow execution so as to require a flow name whenever in multiple flow mode. (Ticket #3)
   </notes>
  </release>
  <release>
   <version>1.6.0</version>
   <date>2006-10-16</date>
   <license>BSD License (revised)</license>
   <state>stable</state>
   <notes>This is the first release with the new PEAR Channel Server pear.piece-framework.com.

This release includes a minor enhancement of Piece_Flow_Continuation class. See the following release notes for details.

## Enhancements ##

### Piece_Flow_Continuation ###
- Moved the location of setting $_currentFlowExecutionTicket and $_activated properties to _start()/_continue() methods for using Piece_Flow_Continuation objects in actions.
   </notes>
  </release>
  <release>
   <version>1.5.0</version>
   <date>2006-08-15</date>
   <license>BSD License (revised)</license>
   <state>stable</state>
   <notes>This release includes an enhancement and breaks backward compatibility as follows:

## Enhancements ##

- Introduced Piece_Flow_Action as the base class for Piece_Flow actions.
- Changed the interface of Piece_Flow actions so as to call setFlow(), setPayload(), and setEvent() methods for passing a Piece_Flow object, a payload, and the event name to an action instead of by the arguments of invoke() method.
- The original Piece_Flow_Action class has been renamed as Piece_Flow_Action_Invoker.
   </notes>
  </release>
  <release>
   <version>1.4.1</version>
   <date>2006-07-28</date>
   <license>BSD License (revised)</license>
   <state>stable</state>
   <notes>This release includes two defect fixes and an enhancement as follows:

## Defect fixes ##

- Removed wrong error handling which disables the current callback.
- Removed &apos;@&apos; operator from include_once.

## Enhancements ##

- Changed the code so as to use $array[] = $value instead of array_push($array, $value).
   </notes>
  </release>
  <release>
   <version>1.4.0</version>
   <date>2006-07-22</date>
   <license>BSD License (revised)</license>
   <state>stable</state>
   <notes>This release includes a few enhancements as follows:

## Enhancements ##

* Piece_Flow_Action
- Adjusted to changes in Stagehand_FSM package.

* Piece_Flow_ConfigReader_Common
- Changed the code so as to get the flow name from the current source.

* the schema of flow definitions
- Removed &apos;name&apos; attribute from &apos;flow&apos; element in piece-flow.rng.
- Removed &apos;name&apos; element in piece-flow.yaml.
   </notes>
  </release>
  <release>
   <version>1.3.0</version>
   <date>2006-07-17</date>
   <license>BSD License (revised)</license>
   <state>stable</state>
   <notes>This release includes a few enhancements as follows:

## Enhancements ##

* Piece_Flow_Action
- Added support for raising an exception when an invalid event is returned from actions.

* Piece_Flow
- Changed the error code from PIECE_FLOW_ERROR_INVALID_OPERATION to PIECE_FLOW_ERROR_ALREADY_SHUTDOWN when triggering events after shutting down a flow.

* Piece_Flow_Continuation
- Changed the code so as never to start a new flow execution again after shtting down in single flow mode.

* Piece_Flow_Error
- Added PIECE_FLOW_ERROR_ALREADY_SHUTDOWN constant.
- Added PIECE_FLOW_ERROR_INVALID_EVENT constant.
   </notes>
  </release>
  <release>
   <version>1.2.1</version>
   <date>2006-07-12</date>
   <license>BSD License (revised)</license>
   <state>stable</state>
   <notes>- Fixed the wrong version number of Stagehand_FSM package from 1.4.0 to 1.5.0.
   </notes>
  </release>
  <release>
   <version>1.2.0</version>
   <date>2006-07-12</date>
   <license>BSD License (revised)</license>
   <state>stable</state>
   <notes>This release includes a few enhancements and fixing two problems as follows:

Enhancements:

* Piece_Flow
- Added support to prevent configuring protected events and states.
- Added error handling for failure to invoke actions.

* Example flow definitions
- Changed some state names and view names to conform the Spring Web Flow best practices.

Defect fixes:

- Fixed the problem that the protected events of the FSM can be triggered by users.
- Fixed the problem that &apos;entry&apos;, &apos;exit&apos;, and &apos;activity&apos; for the last state could not be added.
   </notes>
  </release>
  <release>
   <version>1.1.1</version>
   <date>2006-07-07</date>
   <license>BSD License (revised)</license>
   <state>stable</state>
   <notes>This is a bug fix release.

- Fixed the problem that relative path cannot be used as the cache directory and action cirectory with Solaris.
   </notes>
  </release>
  <release>
   <version>1.1.0</version>
   <date>2006-07-04</date>
   <license>BSD License (revised)</license>
   <state>stable</state>
   <notes>- Piece/Flow.php: Added removeAttribute()/clearAttributs() for removing attributes from flows.
   </notes>
  </release>
  <release>
   <version>1.0.0</version>
   <date>2006-06-19</date>
   <license>BSD License (revised)</license>
   <state>stable</state>
   <notes>The first stable release of Piece_Flow.
   </notes>
  </release>
  <release>
   <version>0.4.0</version>
   <date>2006-04-21</date>
   <license>BSD License (revised)</license>
   <state>beta</state>
   <notes>The first release of Piece_Flow.
   </notes>
  </release>
 </changelog>
</package>
