# $Id$
name: registrationFlow
firstState: displaying
lastState: { name: finishing, view: finish }
viewState:
  - name: displaying
    view: input
    entry:
      class: Piece_FlowTestCaseAction
      method: setupForm
    exit:
      class: Piece_FlowTestCaseAction
      method: teardownForm
    activity:
      class: Piece_FlowTestCaseAction
      method: countDisplay
    transition:
      - event: submit
        nextState: inputValidated
        action:
          class: Piece_FlowTestCaseAction
          method: validateInput
        guard:
          class: Piece_FlowTestCaseAction
          method: isPermitted
  - name: confirming
    view: confirmation
    transition:
      - event: submit
        nextState: confirmationValidated
        action:
          class: Piece_FlowTestCaseAction
          method: validateConfirmation
actionState:
  - name: inputValidated
    transition:
      - event: raiseError
        nextState: displaying
      - event: succeed
        nextState: confirming
  - name: confirmationValidated
    transition:
      - event: raiseError
        nextState: displaying
      - event: succeed
        nextState: registered
        action:
          class: Piece_FlowTestCaseAction
          method: register
  - name: registered
    transition:
      - event: raiseError
        nextState: displaying
      - event: succeed
        nextState: finishing
initial:
  class: Piece_FlowTestCaseAction
  method: initialize
final:
  class: Piece_FlowTestCaseAction
  method: finalize
