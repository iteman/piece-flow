<?xml version="1.0" encoding="UTF-8"?>
<!-- $Id$ -->
<flow name="registrationFlow" firstState="displaying">
  <lastState name="finishing" view="finish"/>
  <viewState name="displaying" view="input">
    <entry class="Piece_FlowTestCaseAction" method="setupForm"/>
    <exit class="Piece_FlowTestCaseAction" method="teardownForm"/>
    <activity class="Piece_FlowTestCaseAction" method="countDisplay"/>
    <transition event="submit" nextState="validated">
      <action class="Piece_FlowTestCaseAction" method="validate"/>
      <guard class="Piece_FlowTestCaseAction" method="isPermitted"/>
    </transition>
  </viewState>
  <viewState name="confirming" view="confirmation">
    <transition event="submit" nextState="validated">
      <action class="Piece_FlowTestCaseAction" method="validate"/>
    </transition>
  </viewState>
  <actionState name="validated">
    <transition event="raiseError" nextState="displaying"/>
    <transition event="succeedInValidatingViaDisplaying" nextState="confirming"/>
    <transition event="succeedInValidatingViaConfirming" nextState="registered">
      <action class="Piece_FlowTestCaseAction" method="register"/>
    </transition>
  </actionState>
  <actionState name="registered">
    <transition event="raiseError" nextState="displaying"/>
    <transition event="succeed" nextState="finishing"/>
  </actionState>
</flow>
