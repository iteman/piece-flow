<?xml version="1.0" encoding="UTF-8"?>
<!-- $Id$ -->
<flow name="registrationFlow" firstState="displaying">
  <initial class="Piece_FlowTestCaseAction" method="initialize"/>
  <final class="Piece_FlowTestCaseAction" method="finalize"/>
  <lastState name="finishing" view="finish"/>
  <viewState name="displaying" view="input">
    <entry class="Piece_FlowTestCaseAction" method="setupForm"/>
    <exit class="Piece_FlowTestCaseAction" method="teardownForm"/>
    <activity class="Piece_FlowTestCaseAction" method="countDisplay"/>
    <transition event="submit" nextState="inputValidated">
      <action class="Piece_FlowTestCaseAction" method="validateInput"/>
      <guard class="Piece_FlowTestCaseAction" method="isPermitted"/>
    </transition>
  </viewState>
  <viewState name="confirming" view="confirmation">
    <transition event="submit" nextState="confirmationValidated">
      <action class="Piece_FlowTestCaseAction" method="validateConfirmation"/>
    </transition>
  </viewState>
  <actionState name="inputValidated">
    <transition event="raiseError" nextState="displaying"/>
    <transition event="succeed" nextState="confirming"/>
  </actionState>
  <actionState name="confirmationValidated">
    <transition event="raiseError" nextState="displaying"/>
    <transition event="succeed" nextState="registered">
      <action class="Piece_FlowTestCaseAction" method="register"/>
    </transition>
  </actionState>
  <actionState name="registered">
    <transition event="raiseError" nextState="displaying"/>
    <transition event="succeed" nextState="finishing"/>
  </actionState>
</flow>
